<p-card
  class="transit-card"
  [class.completed]="line.completed"
  [class.list-view]="viewMode === 'list'"
  (click)="previewLine(line.id)">
  <div class="card-accent" [style.background-color]="line.color"></div>
  <div class="card-header">
    <div class="line-badge" [style.background-color]="line.color">
      {{ line.shortName }}
    </div>
    <div class="line-main">
      <div class="line-title">
        <span class="line-name">{{ line.longName || 'Line ' + line.shortName }}</span>
        <fa-icon class="type-icon" [icon]="getPrimeTypeIcon(line.routeType)"></fa-icon>
      </div>
      <div class="line-location">
        <i class="pi pi-map-marker"></i>
        <span>{{ line.region }}, {{ line.agency.countryCode }}</span>
      </div>
    </div>
    <div class="line-status">
      @if (line.completed) {
        <p-tag value="Collected" icon="pi pi-check" severity="success" [rounded]="true"></p-tag>
      }
    </div>
  </div>

  <div class="line-stats">
    <div class="stat-item">
      <i class="pi pi-sitemap"></i>
      <span>{{ getStationCount(line.points) }} stations</span>
    </div>
    <div class="stat-item">
      <i class="pi pi-compass"></i>
      <span>{{ getDistance(line.points) }} km</span>
    </div>
  </div>

  <div class="card-footer">
    <button
      pButton
      [outlined]="line.completed"
      [severity]="line.completed ? 'secondary' : 'primary'"
      [icon]="line.completed ? 'pi pi-check' : (viewMode === 'list' ? null : 'pi pi-plus')"
      (click)="$event.stopPropagation(); onToggleCompletion()"
      class="completion-button"
      type="button"
    >
      {{
        line.completed
          ? (viewMode === 'list' ? 'Collected' : 'In Your Collection')
          : (viewMode === 'list' ? 'Collect' : 'Add to Collection')
      }}
    </button>
  </div>
</p-card>
