<div class="line-detail">
  <header class="detail-header">
    <button type="button" class="back-button" (click)="goBack()">
      <i class="pi pi-arrow-left"></i>
    </button>
    <span class="header-title">Line details</span>
  </header>

  <div class="map-preview">
    <app-route-viewer [interactive]="false"></app-route-viewer>
  </div>

  @if (line$ | async; as line) {
    <div class="detail-content">
      <div class="title-row">
        <div>
          <h2>{{ line.longName || ('Line ' + line.shortName) }}</h2>
          <p>{{ line.region || line.agency?.name }} Â· {{ line.agency?.countryCode }}</p>
        </div>
        <span class="badge">{{ line.shortName }}</span>
      </div>

      <div class="stats-row">
        <div class="stat">
          <span class="stat-label">Stops</span>
          <span class="stat-value">{{ (line.stopCount ?? line.points ?? 0) | number:'1.0-0' }}</span>
        </div>
        <div class="stat">
          <span class="stat-label">Route type</span>
          <span class="stat-value">{{ getTypeLabel(line.routeType) }}</span>
        </div>
      </div>

      <button
        pButton
        class="visit-button"
        [outlined]="line.completed"
        [severity]="line.completed ? 'secondary' : 'primary'"
        (click)="toggleVisited()">
        {{ line.completed ? 'Visited' : 'Mark as Visited' }}
      </button>
    </div>
  }
</div>
